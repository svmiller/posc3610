---
output: 
  stevetemplates::beamer:
    latex_engine: xelatex # use xelatex here instead! I recommend it, but this is minimal reprex
    dev: cairo_pdf # I typically comment this out  if latex_engine: pdflatex
    slide_level: 3 # I prefer this, but I won't force it on you.
title: "Territorial Conflict"
subtitle: POSC 3610  -- International Conflict
author: Steven V. Miller
institute: Department of Political Science
titlegraphic: "`r paste0(Sys.getenv('HOME'), '/Dropbox/clemson/watermarks/clemson-university-wordmark-orange-purple.png')`"
make149: true
mainfont: "Open Sans"
titlefont: "Titillium Web"
header-includes:
- \usepackage{dcolumn}
- \usepackage{booktabs}
- \usepackage{longtable}
- \usepackage{array}
- \usepackage{multirow}
- \usepackage{wrapfig}
- \usepackage{float}
- \usepackage{colortbl}
- \usepackage{pdflscape}
- \usepackage{tabu}
- \usepackage{threeparttable}
---



```{r setup, include=FALSE, cache=F, message=F, warning=F, results="hide"}
knitr::opts_chunk$set(cache=TRUE, warning=F)
knitr::opts_chunk$set(fig.path='figs/')
knitr::opts_chunk$set(cache.path='cache/')

knitr::opts_chunk$set(
                  fig.process = function(x) {
                      x2 = sub('-\\d+([.][a-z]+)$', '\\1', x)
                      if (file.rename(x, x2)) x2 else x
                      }
                  )
```


```{r loadstuff, include=FALSE}
knitr::opts_chunk$set(cache=TRUE, echo=FALSE, message=FALSE, warning=FALSE)
options(knitr.kable.NA = '')
library(tidyverse)
library(stevemisc)
library(peacesciencer)
library(fixest)
library(kableExtra)
library(modelsummary)
library(patchwork)

options("modelsummary_format_numeric_latex" = "plain")

```

```{r loaddata, cache=T, eval=T, echo=F, message=F, error=F, warning=F}

# NMC <- read_csv("~/Dropbox/data/cow/nmc/6.0/NMC-60-abridged.csv")
# FAS <- read.csv("~/Dropbox/data/fas-nukes/number-of-nuclear-warheads-in-the-inventory-of-the-nuclear-powers-1945-2014.csv") %>% tbl_df()
# 
Mods <- readRDS("Mods.rds")
Sims <- readRDS("Sims.rds")
Data <- readRDS("Data.rds")

# cow_ddy %>%
#   filter(ccode1 == 652 & ccode2 == 666) %>%
#   add_nmc() %>%
#   select(ccode1:year, cinc1, cinc2) %>%
#     mutate(ccode1 = "Syria",
#          ccode2 = "Israel") %>%
#   mutate(ndircincprop = ifelse(cinc1 > cinc2, cinc2/cinc1, cinc1/cinc2)) -> isr_syr
```

# Introduction
### Goal for Today

*Discuss the primacy of territory to understanding inter-state conflict.*

### MIC of the Day: First Indo-Pakistani (Kashmir) War (MIC#1238)

<!-- A young refugee in Delhi in August 1947 squats on the rubble of a ruined Sultanate monument, holding his head in despair. In the background, a vast Muslim refugee camp sprawls out as far as the eye can see. â€” Excerpted with permission from Witness to Life and Freedom, Roli Books, Delhi -->

```{r india-refugee-boy, eval=TRUE, echo=FALSE, out.width="80%"}
knitr::include_graphics("india-refugee-boy-1947.jpg")
```

<!-- ### Dangerous Dyads -->

<!-- | **Factor** | **Rank** | **Relationship** | -->
<!-- |:----------|:-------:|:-------------------:| -->
<!-- | Contiguity | 1 | + | -->
<!-- | Major power in the dyad | 2 | + | -->
<!-- | Shared alliance | 3 | - | -->
<!-- | Joint Militarization | 4 | + | -->
<!-- | Joint democracy | 5 | - | -->
<!-- | Jointly advanced economies | 6 | - | -->
<!-- | Power preponderance | 7 | - | -->


<!-- Table: Bremer's (1992) "Dangerous Dyads" -->

<!-- ### Why Are Contiguous States Prone to Conflict? -->

<!-- 1. Opportunity -->
<!-- 2. Interactions/Willingness -->
<!-- 3. Territory -->


### The "Correlates" of War


We knew very little of the issues states contest in war by the 1990s.

- Diehl (1992): data limitations, structural realism, the "black box" of the state.

However, we understand as politics as "who gets what, when, and how" (per Harold Laswell).

- In IR, we had no real understanding of the "what."
- Distribution problems pervade *all* levels of politics.

But, it seems issues must be underlying inter-state conflict.

- Contiguity was our clue, but not our answer.


### The Contiguity Arguments

1. Opportunity
2. Interactions/Willingness

### The Problem of Opportunity


The opportunity argument suggests neighbors fight because they can.

- We've yet to observe war in the Nigeria-Mongolia dyad, for example.
- Bolivia has fought Paraguay lots of times, but never Botswana.

What this is really predicting is the projection of great power status.

- Non-contiguous states should fight when they are powerful enough to send the military to great distances.
- This would work well in the case of the U.S.

### The Problem of Opportunity

Beyond that, this argument has limited explanatory value.

- It basically explains a (rare) outcome with what amounts to a constant.

i.e. you're almost always going to have the same neighbors.

- Cases like the partition of Poland are exceptional events.

We're left with arguing about "necessity" for cause of the sampling frame.

### The Problem of Interaction

The interaction argument suggests states fight over points of interest.

- Neighbors would have more points of interest as they interact more.
- The more sources for disagreement, the more likely they militarize.


### The Problem of Interaction

However, this link is questionable.

- We do not have to accept the premises.
- More interaction may create more opportunity for cooperation.

This argument is incurably underspecified.

## Territoriality
### Territoriality

Vasquez argues neighbors fight because they disagree about the distribution of territory among them.

- Contiguity is a raw proxy for territorial disputes.

### Territoriality

His argument draws upon a variety of sources.

- Primitive anthropology: land is important to survival and fecundity.
- Evolutionary psychology: aggression in defense of territory is a learned response.
- Sociobiology: we are "soft-wired" to violence toward that end.

This aggregates to the level of the state in the international system.

### Other Arguments for Territory's Importance

1. Tangible value
    - "Strategic value" largely falls here too.
2. Intangible value
3. Reputation concerns


###

```{r distribution-wars-1648-1990-holsti-vasquez, eval=T, echo=F, fig.height=8.5, fig.width=14, message = F}
tribble(
  ~period, ~Type, ~perc, ~count,
  #-----, -------, -----, -----
  "1648-1714", "Territory", 77, 17,
  "1648-1714", "Territory + Territory-related", 86, 19,
  "1648-1714", "Other Issue", 14, 3,
  "1715-1814", "Territory", 72, 26,
  "1715-1814", "Territory + Territory-related", 83, 4+26,
  "1715-1814", "Other Issue", 17, 6,
  "1815-1914", "Territory", 58, 18,
  "1815-1914", "Territory + Territory-related", 84, 18+8,
  "1815-1914", "Other Issue", 16, 5,
  "1918-1941", "Territory", 73, 22,
  "1918-1941", "Territory + Territory-related", 93, 28,
  "1918-1941", "Other Issue", 7, 2,
  "1945-[1990]", "Territory", 47, 27,
  "1945-[1990]", "Territory + Territory-related", 79, 27+19,
  "1945-[1990]", "Other Issue", 21, 12
) %>%
  mutate(Type = forcats::fct_relevel(Type, "Territory", "Territory + Territory-related", "Other Issue"),
         perc = perc/100) %>%
  ggplot(.,aes(x=period, y=perc, fill=Type)) + theme_steve_web() +
  geom_bar(stat="identity", position = "dodge",
           alpha = I(0.8), color="black") +
  xlab("Historical Period") + ylab("Percentage of All Wars") +
  scale_y_continuous(labels = scales::percent) +
  labs(title = "Percentage and Frequency of Wars By Issue Type, 1648-1990",
       subtitle = "Most wars over time have been fought over territory or territory-related issues than other issue types.",
       caption = "Data: Vasquez (1993) via Holsti (1991). Note: counts appear on top of the bars by issue-type.") +
  geom_text(aes(label = count, group = Type), color="black",
            position = position_dodge(width=.9), size=4,
            vjust = -.5, family ="Open Sans") +
  labs(fill = "")

```

### Thinking About Onset *and* Escalation

With CoW-MID v. 2 to thank, a slew of studies in the 90s-00s showed territorial disputes led to war more than other issues. However:

- Efforts at unifying analyses at onset and escalation phases lagged (again: data limitations).
- Theoretical efforts also lagged a bit as well.

Per Senese and Vasquez (2003, Table 1), it's plausible that:

- Territory is conflict-prone, but not war-prone
- Territory is war-prone, but not conflict-prone.
- Territory is both conflict-prone *and* war-prone.
- Territory is neither of these (i.e. we've screwed everything up).


# A Dyadic Analysis of Contiguity and Conflict
### What Does This Look Like Dyadically?

**Unit of analysis**: non-directed dyad-year

- *dyad*: a pairing of any two states (e.g. USA-Canada, India-Pakistan)
- *year*: should be intuitive
- *non-directed*: USA-Canada and Canada-USA are observationally the same.
    - Useful for explaining simple onsets.
    - Operationally: keep the dyad where `ccode2` > `ccode1`.
    
### Dependent Variables

**Dependent Variables**: (i.e. the thing(s) we want to explain)

- *confrontation onset*: binary, indicates a unique confrontation onset in dyad-year
- *sum of minimum fatalities*: total (minimum) estimated fatalities in dyad-year
- *sum of maximum fatalities*: total (maximum) estimated fatalities in dyad-year
- *dyadic war*: whether a confrontation escalated to over 1,000 dyadic (minimum) fatalities

### Main Independent Variable(s)

**Main Independent Variable(s)**: indicators of disputed territory

- *Territorial claim*: whether there is a territorial claim in the dyad-year (ICOW)
- *Territorial rivalry*: whether the dyad is characterized as in a spatial (i.e. territorial) rivalry (Thompson and Dreyer, 2012). 


One lament: we could benefit from better data on this front.

- ICOW is promising, but still under development.
- Rivalry is a better measure of salience, but also a measure of rivalry.
- The old `revtype` variables in CoW-MID are unusable (e.g. Gibler, 2017; Gibler and Miller, Forthcoming)


###

```{r per-claims, echo=F, eval=T, fig.width = 14, fig.height = 8.5}

Data[[1]] %>%
  ggplot(.,aes(year, perclaim)) + geom_line() +
  theme_steve_web() +
  geom_ribbon(aes(ymin=-Inf, ymax=perclaim),
              alpha=0.3, fill="skyblue3")  +
  scale_x_continuous(breaks = seq(1820, 2020, by=10)) +
  scale_y_continuous(labels = scales::percent) +
  labs(y = "Percentage", x= "",
       title = "The Percentage of States in the State System with at Least One Territorial Claim, 1816-2015",
       subtitle = "You kind of see the implied Pax Britannica early in the data, and what unification/nationalism movements did for the emergence of more territorial claims.",
       caption = "Data: ICOW (provisional, 1.1). Claims extended by me (reasonably, I think) on case-by-case basis for an exercise in 2016. Use with caution, but see Miller (forthcoming).")

```

###


```{r, eval=T}

Data[[2]] %>%
  head(10) %>%
  select(-region, -claimdy, -dyadnum) %>%
   kable(., caption="A Select Group of 19th Century Territorial Claims for the United States",
        longtable = T, booktabs = TRUE, linesep='',
        col.names = c("Claim No.", "Name", "Challenger", "Target", "Beg. Claim", "End Claim"),
        align = c("c","l","c","c","c","c")) %>%
  kable_styling(font_size = 9) %>%
  row_spec(0, bold=TRUE) %>%
  footnote(general = "Data: ICOW (provisional, 1.1)")
```


###

```{r, eval=T}

Data[[3]] %>%
   select(-region, -claimdy, -dyadnum) %>%
   kable(., caption="The Three Ongoing Territorial Claims for the United States",
        longtable = T, booktabs = TRUE, linesep='',
        col.names = c("Claim No.", "Name", "Challenger", "Target", "Beg. Claim", "End Claim"),
        align = c("c","l","c","c","c","c")) %>%
  kable_styling(font_size = 9) %>%
  row_spec(0, bold=TRUE) %>%
  footnote(general = "Data: ICOW (provisional, 1.1). Extensions into 2016 are my codings, not ICOW's.")
```

###

```{r per-spatial, echo=F, eval=T, fig.width = 14, fig.height = 8.5}

Data[[4]] %>%
  filter(year >= 1816) %>%
  ggplot(.,aes(year, prop)) + geom_line() +
  theme_steve_web() +
  scale_x_continuous(breaks = seq(1820, 2020, by=10)) +
  geom_ribbon(aes(ymin=-Inf, ymax=prop),
              alpha=0.3, fill="skyblue3") +
  scale_y_continuous(labels = scales::percent) +
  labs(y = "Percentage", x= "",
       title = "The Percentage of Spatial (Territorial) Rivalries, Among All Rivalry Types, 1816-2010",
       subtitle = "Most rivalries concern territory. Almost all of them did prior to 1816. Fewer concern territory now, but it's still the most common rivalry type.",
       caption = "Data: Thompson and Dreyer (2012) strategic rivalry data. Spatial rivalries coded for whether `type1` or `type2` was 'spatial'.")

```

### Control Variables

**Control Variables**:

- CINC proportion (W/S), land/water contiguity, major powers in the dyad, defense pact, joint democracy, advanced economies

**Other notes**: (i.e. things that academics care a lot about)

- Confrontation data: Gibler and Miller (Forthcoming)
- Sample: politically relevant dyads (i.e. neighbors and/or dyads with a major power)
- Onset estimated using logistic regression. 
- Fatalities estimated with Heckman sample correction, selecting on ongoing confrontations.
    - Otherwise: basic OLS ("linear regression").
- War model is probit with Heckman sample correction.
    
###

```{r reg-table-1, echo=F, eval=T, fig.width = 14, fig.height = 8.5, warning = F, message = F, results="asis"}

modelsummary(list("Conf. Onset" = Mods[[1]], "Min. Fatalities" = Mods[[3]], 
                  "Max. Fatalities" = Mods[[4]],
                  "Dyadic War" = Mods[[5]]),
             # output="latex",  
             longtable=TRUE,
             title = "A Dangerous Dyad-ish Analysis of Inter-state Conflict",
             gof_omit = "IC|F|Log.|R2$|R2",
             coef_map = c("claim" = "Territorial Claim",
                          "spatial" = "Territorial Rivalry",
                          "landcontig" = "Land Contiguity",
                          "othercontig" = "Other Contiguity",
                          "ndircincprop" = "CINC Proportion",
                          "bothmaj" = "Both Major Powers",
                          "onlyonemaj" = "Major-Minor",
                          "cow_defense" = "Defense Pact",
                          "jointdem" = "Joint Democracy",
                          "minwbgdppc" = "Min. GDP per Capita in Dyad"),
             stars = TRUE) %>%
  kable_styling(font_size = 7) %>%
  footnote(general = "I'm aware that there's a separation problem in Model 5 for joint democracy. Stay out of my mentions.")

```



### How to Interpret a Regression Table Like This

1. Find the variable(s) of interest.
2. Look for direction (positive/negative)
3. Look for "stars" (to determine statistical significance)



###

```{r reg-table-2, echo=F, eval=T, fig.width = 14, fig.height = 8.5, warning = F, message = F, results="asis"}

modelsummary(list("Conf. Onset" = Mods[[1]], "Min. Fatalities" = Mods[[3]], 
                  "Max. Fatalities" = Mods[[4]],
                  "Dyadic War" = Mods[[5]]),
             # output="latex",  
             longtable=TRUE,
             title = "The Important Results of Our Analysis (Omitting the Control Variables)",
             gof_omit = "IC|F|Log.|R2$|R2",
             coef_map = c("claim" = "Territorial Claim",
                          "spatial" = "Territorial Rivalry"),
             stars = TRUE)  %>%
  kable_styling(font_size = 8)  %>%
  column_spec(1, italic = FALSE, color='#000000')

```


###

```{r reg-table-3, echo=F, eval=T, fig.width = 14, fig.height = 8.5, warning = F, message = F, results="asis"}

modelsummary(list("Conf. Onset" = Mods[[1]], "Min. Fatalities" = Mods[[3]], 
                  "Max. Fatalities" = Mods[[4]],
                  "Dyadic War" = Mods[[5]]),
             # output="latex",  
             longtable=TRUE,
             title = "The Important Results of Our Analysis (Omitting the Control Variables and Color Coded)",
             gof_omit = "IC|F|Log.|R2$|R2",
             coef_map = c("claim" = "Territorial Claim",
                          "spatial" = "Territorial Rivalry"),
             stars = TRUE)  %>%
  kable_styling(font_size = 8) %>%
  column_spec(c(2, 3, 4,5), color = c(rep("#00cc00", 4), "black"))
```

###

```{r reg-table-4, echo=F, eval=T, fig.width = 14, fig.height = 8.5, warning = F, message = F, results="asis"}

modelsummary(list("Conf. Onset" = Mods[[1]], "Min. Fatalities" = Mods[[3]], 
                  "Max. Fatalities" = Mods[[4]],
                  "Dyadic War" = Mods[[5]]),
            # output="latex",  longtable=TRUE,
             title = "The Important Results of Our Analysis (Omitting the Control Variables, Color Coded, Identifying Significance)",
             gof_omit = "IC|F|Log.|R2$|R2",
             coef_map = c("claim" = "Territorial Claim",
                          "spatial" = "Territorial Rivalry"),
             stars = TRUE)  %>%
  kable_styling(font_size = 8) %>%
  column_spec(c(2, 3, 4,5), color = c(rep("#00cc00", 4), "black")) %>%
  column_spec(2, bold = c(rep(TRUE, 4), FALSE)) %>%
  column_spec(2, color = c(rep("#00cc00", 4), "black"),
              bold = c(rep(TRUE, 4), FALSE)) %>%
  column_spec(c(3,4,5), bold = c(rep(FALSE, 2), rep(TRUE, 2), FALSE))

```

### Takeaways

*Territory is a root cause of confrontation onset and escalation*.

- Dyads with territorial issues are more likely to experience confrontation onset.
- Confrontations in these dyads are more likely to be severe.
- Confrontations in these dyads are more likely to escalate to dyadic war.
- The territorial rivalry indicator might be a better indicator than the claim indicator, if you had to pick one (c.f. Gibler and Miller, forthcoming).

### Other Considerations


- Claims and rivalry indicators only mostly agree (c.f. Miller, forthcoming)
- The claims data have a lot of dogs that don't bark (c.f. Miller et al. 2020, Miller, 2022)
- Absent a single, more coherent measure of "territorial dispute", we work with what we have.
- Attribution is still tricky here, and it's mostly implied.


<!-- ### -->

```{r sim-onset, echo=F, eval=F, fig.width = 14, fig.height = 8.5}

Sims[[1]] %>%
  mutate(y = plogis(y)) %>%
  mutate(cat = case_when(
    claim == 0 & spatial == 0 ~ "No Claim, No Territorial Rivalry",
    claim == 1 & spatial == 0 ~ "Claim, No Territorial Rivalry",
    claim == 0 & spatial == 1 ~ "No Claim, Territorial Rivalry",
    claim == 1 & spatial == 1 ~ "Claim, Territorial Rivalry"
  )) %>%
  mutate(cat = fct_inorder(cat)) %>%
  group_by(cat) %>%
  summarize(mean = mean(y),
            lwr = quantile(y, .025),
            upr = quantile(y, .975)) %>%
  ggplot(.,aes(cat, mean, ymin=lwr, ymax=upr)) +
  geom_pointrange(size = 1.1) +
  theme_steve_web() +
  coord_flip() +
  labs(y = "Mean Probability of Confrontation Onset (with 95% Intervals)",
       x = "",
       title = "The Simulated Probability of Confrontation Onset, by Territorial Threat Type",
       subtitle = "Claims have much stronger effects on confrontation onset than territorial rivalries. No matter, the combined effect is a ~331% increase in a confrontation onset.",
       caption = "Simulation by way of multivariate normal distribution, given Model 1 in this presentation.")

```


<!-- ### -->

```{r sim-dywar, echo=F, eval=F, fig.width = 14, fig.height = 8.5}

Sims[[2]] %>%
  mutate(y = pnorm(y)) %>%
  mutate(cat = case_when(
    claim == 0 & spatial == 0 ~ "No Claim, No Territorial Rivalry",
    claim == 1 & spatial == 0 ~ "Claim, No Territorial Rivalry",
    claim == 0 & spatial == 1 ~ "No Claim, Territorial Rivalry",
    claim == 1 & spatial == 1 ~ "Claim, Territorial Rivalry"
  )) %>%
  mutate(cat = fct_inorder(cat)) %>%
  group_by(cat) %>%
  summarize(mean = mean(y),
            lwr = quantile(y, .025),
            upr = quantile(y, .975)) %>%
  ggplot(.,aes(cat, mean, ymin=lwr, ymax=upr)) +
  geom_pointrange(size = 1.1) +
  theme_steve_web() +
  coord_flip() +
  labs(y = "Mean Probability of Confrontation Escalation to Dyadic War (with 95% Intervals)",
       x = "",
       title = "The Simulated Probability of Confrontation Escalation to Dyadic War, by Contiguity Relationship",
       subtitle = "Contiguity is a correlate of confrontations, not necessarily a 'correlate of war'.",
       caption = "Simulation by way of multivariate normal distribution, given Model 5 in this presentation.")

```

# Conclusion
### Conclusion

Territory is effectively a root cause of war.

- More wars are fought over territory than other issues.
- Consistent relationship at onset and escalation phases.
- Contiguity is, in effect, a rough proxy for disputing territory.
- Data limitations preclude more confidence in what we know.
